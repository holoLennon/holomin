appctrl.controller("CloudPharmacyCtrl",function(e,t,r,a,c,i,n,o,l,u,d,p,g,f,h,s,y){p.debug("enter CloudPharmacy ctrl");e.page=_.clone(_Page);e.list=[];e.$on("$ionicView.beforeEnter",function(){p.debug("CloudPharmacy ctrl beforeEnter")});e.$on("$ionicView.afterEnter",function(){p.debug("CloudPharmacy ctrl afterEnter");if(ctrlReinitMap.get("CloudPharmacyCtrl")){ctrlReinitMap.remove("CloudPharmacyCtrl");p.debug("CloudPharmacy ctrl afterEnter init");e.init()}});e.init=function(){p.debug("CloudPharmacy ctrl init ");e.pcc=areaTree;e.province=areaTree[3];e.city=e.province.children[0];e.county=e.city.children[1];e.page.where="productTypeId="+ProductTypeNew;e.page.pageNo=1;e.page.hasNextPage=false;e.list=[];e.first()};e.doRefresh=function(){e.init()};e.addList=function(t){angular.forEach(t,function(t){var r=t.productIdProductObj.agentarea;var a=parseInt(e.city.id/100)*100;var c=parseInt(e.province.id/1e4)*1e4;if(r==e.county.id||r==0||r==a||r==c){p.debug(r+"----"+a+"------"+c);e.list.push(t)}});if(t&&t.length<e.page.pageSize){e.page.hasNextPage=false}else{e.page.hasNextPage=true}};e.first=function(){h.first(null,e.page).then(function(t){p.debug("CloudPharmacy ctrl query then");e.addList(t);e.$broadcast("scroll.refreshComplete")})};e.more=function(){p.debug("CloudPharmacy ctrl more=========");if(!e.page.hasNextPage){return}h.more(e.page).then(function(t){p.debug("CloudPharmacy ctrl more then");e.addList(t);e.$broadcast("scroll.infiniteScrollComplete")})};e.searchByCounty=function(t,r,a){e.county=t;e.city=r;e.province=a;e.page.where="productTypeId="+ProductTypeNew;e.page.pageNo=1;e.page.hasNextPage=false;e.list=[];e.first()};e.init();ctrlReinitMap.remove("CloudPharmacyCtrl")});