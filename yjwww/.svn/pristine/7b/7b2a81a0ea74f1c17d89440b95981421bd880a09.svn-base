appctrl.controller("DoctorCtrl",function(e,n,t,o,r,a,i,c,u,l,d,s,f,g,p,h,b,m,j,v){t.debug("enter Doctor ctrl");e.page=_.clone(_Page);var D=f.id;e.list=[];e.obj={};var P="http://yijian.zjjnyd.com/yijian/rest";e.$on("$ionicView.beforeEnter",function(){t.debug("Doctor ctrl beforeEnter")});e.$on("$ionicView.afterEnter",function(){t.debug("Doctor ctrl afterEnter");if(ctrlReinitMap.get("DoctorCtrl")){ctrlReinitMap.remove("DoctorCtrl");t.debug("Doctor ctrl afterEnter init");e.init()}});e.init=function(){e.get()};e.makeProductchannelId=function(){t.debug("productchannelId"+e.obj.productchannelId);e.obj.productchannelId=e.obj.productchannelIdProductchannelObj.id};e.get=function(){if(!D)return;b.get(D).then(function(n){t.debug("DoctorService ctrl get then");e.obj=n;e.dataProcessing(n)})};e.dataProcessing=function(n){angular.forEach(n.obj1,function(t){angular.forEach(t.children,function(o){if(n.productchannelId==o.id){e.obj.productchannelIdProductchannelObj=o;e.obj.ks1=t}})})};e.save=function(){t.debug("Doctor ctrl get id="+D);e.makeProductchannelId();t.debug(e.obj);if(isblank0(D)){return}else{b.update(e.obj).then(function(e){t.debug("Doctor ctrl update then");h.alertm("修改成功");g.goBack()})}};e.uploadsave=function(){t.debug("Doctor ctrl get id="+D);t.debug(e.obj);if(isblank0(D)){}else{b.update(e.obj).then(function(n){t.debug("Doctor ctrl update then");e.dataProcessing(n);h.alertm("上传成功")})}};e.upload=function(n,t){e.errorMsg=null;k(n,t)};function k(n,r){n.upload=m.upload({url:P+"/upload"+e.getReqParams(),resumeSizeUrl:r?P+"/upload?name="+encodeURIComponent(n.name):null,resumeChunkSize:r?e.chunkSize:null,headers:{"optional-header":"header-value"},data:{username:e.username},file:n}).progress(function(n){e.progressPercentage=parseInt(100*n.loaded/n.total);t.debug("progess:"+e.progressPercentage+"%"+n.config.file.name)}).success(function(n){angular.forEach(n.result,function(n){if(n.fieldName=="url"){t.debug(n.value);if(n.value!=null){var o="http://yijian.zjjnyd.com/yijian"+n.value;e.obj.imgqa=o;e.uploadsave()}}})});n.upload.then(function(e){o(function(){n.result=e.data})},function(n){if(n.status>0)e.errorMsg=n.status+": "+n.data},function(e){n.progress=Math.min(100,parseInt(100*e.loaded/e.total))});n.upload.xhr(function(e){})}e.$watch("files",function(n){t.debug(n);if(n!=null){if(!angular.isArray(n)){o(function(){e.files=n=[n]});return}for(var r=0;r<n.length;r++){m.imageDimensions(n[r]).then(function(n){e.d=n;console.log(n)});e.errorMsg=null;(function(n){e.upload(n,true)})(n[r])}}});e.isResumeSupported=m.isResumeSupported();e.chunkSize=1e5;e.success_action_redirect=e.success_action_redirect||window.location.protocol+"//"+window.location.host;e.jsonPolicy=e.jsonPolicy||'{\n  "expiration": "2020-01-01T00:00:00Z",\n  "conditions": [\n    {"bucket": "angular-file-upload"},\n    ["starts-with", "$key", ""],\n    {"acl": "private"},\n    ["starts-with", "$Content-Type", ""],\n    ["starts-with", "$filename", ""],\n    ["content-length-range", 0, 524288000]\n  ]\n}';e.acl=e.acl||"private";e.getReqParams=function(){return e.generateErrorOnServer?"?errorCode="+e.serverErrorCode+"&errorMessage="+e.serverErrorMsg:""};e.modelOptionsObj={};e.init();ctrlReinitMap.remove("DoctorCtrl")});