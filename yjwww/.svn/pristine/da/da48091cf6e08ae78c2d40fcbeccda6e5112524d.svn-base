appctrl.controller("OrderrCtrl",function(e,r,t,n,i,o,c,d,l,a,b,u,g,f,m,s,O,j){g.debug("enter Orderr ctrl");var R=u.id;e.vm={};e.vm.isedit=R=="0";e.obj={};e.memberDoctorWatching={};e.$on("$ionicView.beforeEnter",function(){g.debug("Orderr ctrl1 beforeEnter")});e.$on("$ionicView.afterEnter",function(){g.debug("Orderr ctrl afterEnter");if(ctrlReinitMap.get("OrderrCtrl")){ctrlReinitMap.remove("OrderrCtrl");g.debug("Orderr ctrl afterEnter init");e.init()}e.memberDoctorWatching=f.get(MEMBER_DOCTOR_WATCHING);g.debug("$scope.memberDoctorWatching");g.debug(e.memberDoctorWatching);e.obj.memberId=e.memberDoctorWatching.id});e.init=function(){g.debug("Orderr ctrl init id="+R);e.get()};e.getlocal=function(){g.debug("Orderr ctrl getlocal id="+R);if(isblank0(R)){e.obj=_.clone(_Orderr)}else{e.obj=j.getlocal(R)}g.debug(e.obj)};e.get=function(){g.debug("Orderr ctrl get id="+R);if(isblank0(R)){j.newget().then(function(r){g.debug("Orderr ctrl newget then");e.obj=r;e.obj.memberId=e.memberDoctorWatching.id;if(f.get(NOW_ORDERR_DIAG))e.obj.diagnose=f.get(NOW_ORDERR_DIAG);g.debug(e.obj)})}else{j.get(R).then(function(r){g.debug("Orderr ctrl get then");e.obj=r})}};e.saveOrderr=function(){g.debug("Orderr ctrl get id="+R);g.debug(e.obj);if(isblanklist(e.listCart)){O.alertm("亲，药笺中未选药,药笺无效哦").then(function(e){});return}if(isblanklist(e.obj.diagnose)){O.alertm("亲，还未诊断哦，请填写诊断信息").then(function(e){});return}for(var r=0;r<e.listCart.length;r++){var t=e.listCart[r];t.obj1=null}e.obj.listorderrdetail=e.listCart;e.vm.isedit=false;e.obj.obj1=window.JSON.stringify(e.obj.listorderrdetail);e.obj.myname=null;e.obj.mynameid=null;if(isblank0(R)){j.create(e.obj).then(function(r){g.debug("Orderr ctrl save then");e.obj=r;f.remove(NOW_ORDERR_DIAG)})}else{j.update(e.obj).then(function(r){g.debug("Orderr ctrl update then");e.obj=r;f.remove(NOW_ORDERR_DIAG)})}angular.forEach(f.get(LISTCART),function(r){var t=e.cartFindIndex(r.productId);if(t>-1){e.listCart.remove(t)}f.set(LISTCART,e.listCart);if(e.listCart.length==0){e.listCart=null}});e.refereshPrice()};e.clickx=function(){if(R==="0")goBack()};e.addNum=function(e){if(e.num>=1){e.num+=1}};e.reduceNum=function(e){if(e.num>1){e.num-=1}};e.addNewProduct=function(){g.debug("abc"+JSON.stringify(f.get(LISTCART)));f.set(NOW_ORDERR_DIAG,e.obj.diagnose);e.cartSaveLocal();e.rx("#/tab/DoctorProductList/1")};e.init();ctrlReinitMap.remove("OrderrCtrl")});