appctrl.controller("ProductTypeLinkProductListHomeCtrl",function(e,t,r,i,o,n,c,a,d,u,p,s,l,g,f,P,L,y){s.debug("enter ProductTypeLinkProductListHome ctrl");e.page=_.clone(_Page);e.list=[];e.page2=_.clone(_Page);e.doctor_id=0;if(l.get(LOGINED_USER_B)!=null){e.doctor_id=l.get(LOGINED_USER_B).id}e.page2.where="doctor_id="+e.doctor_id;e.dmsgnum=0;e.$on("$ionicView.beforeEnter",function(){s.debug("ProductTypeLinkProductListHome ctrl beforeEnter")});e.$on("$ionicView.afterEnter",function(){s.debug("ProductTypeLinkProductListHome ctrl afterEnter");if(ctrlReinitMap.get("ProductTypeLinkProductListHomeCtrl")){ctrlReinitMap.remove("ProductTypeLinkProductListHomeCtrl");s.debug("ProductTypeLinkProductListHome ctrl afterEnter init");e.init()}});e.init=function(){s.debug("ProductTypeLinkProductListHome ctrl init ");if(wxNoOpenid()){window.location.href=outGetOpenidUrl_b;return}e.pcc=areaTree;e.province=areaTree[3];e.city=e.province.children[0];e.county=e.city.children[1];e.page.where="productTypeId="+ProductTypeNew;e.page.pageNo=1;e.page.hasNextPage=false;e.list=[];e.first();e.havaMessage()};e.doRefresh=function(){e.init()};e.havaMessage=function(){y.first(null,e.page2).then(function(t){angular.forEach(t,function(t){if(t.dmsgnotread>0){e.dmsgnum++}})})};e.addList=function(t){angular.forEach(t,function(t){var r=t.productIdProductObj.agentarea;var i=parseInt(e.city.id/100)*100;var o=parseInt(e.province.id/1e4)*1e4;if(r==e.county.id||r==0||r==i||r==o){s.debug(r+"----"+i+"------"+o);e.list.push(t)}});if(t&&t.length<e.page.pageSize){e.page.hasNextPage=false}else{e.page.hasNextPage=true}};e.first=function(){f.first(null,e.page).then(function(t){s.debug("ProductTypeLinkProductListHome ctrl query then");e.addList(t);e.$broadcast("scroll.refreshComplete")})};e.more=function(){s.debug("ProductTypeLinkProductListHome ctrl more=========");if(!e.page.hasNextPage){return}f.more(e.page).then(function(t){s.debug("ProductTypeLinkProductListHome ctrl more then");e.addList(t);e.$broadcast("scroll.infiniteScrollComplete")})};e.searchByCounty=function(t,r,i){e.county=t;e.city=r;e.province=i;e.page.where="productTypeId="+ProductTypeNew;e.page.pageNo=1;e.page.hasNextPage=false;e.list=[];e.first()};e.init();ctrlReinitMap.remove("ProductTypeLinkProductListHomeCtrl")});